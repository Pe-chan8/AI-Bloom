<%# mode: :modal (新規) / :page (編集) を想定。デフォルトは :page %>
<% mode ||= :page %>

<%= form_with model: post do |f| %>
  <div class="mb-4">
    <%= f.label :body, "今日のメモ" %><br>
    <%= f.text_area :body,
          class: "w-full border rounded-lg p-3",
          rows: 6,
          placeholder: "いまの気持ちを書いてみよう…" %>
  </div>

  <div class="mt-4 flex justify-end gap-2">
    <% if mode == :modal %>
      <!-- モーダル版：JavaScript で閉じる -->
      <button
        type="button"
        class="px-4 py-2 rounded-lg border border-slate-300 text-slate-600"
        onclick="(function(){
          var modal = document.getElementById('post-modal');
          var frame = document.getElementById('post_form_frame');
          if (modal) modal.style.display = 'none';
          if (frame) frame.innerHTML = '';
        })();"
      >
        やめる
      </button>
    <% else %>
      <!-- ページ版：前のページ or ホームに戻る -->
      <%= link_to "やめる",
                  request.referer.presence || root_path,
                  class: "px-4 py-2 rounded-lg border border-slate-300 text-slate-600 inline-block" %>
    <% end %>

    <%= f.submit (post.persisted? ? "更新する" : "投稿する"),
          class: "bg-sky-500 text-white px-4 py-2 rounded-lg hover:bg-sky-600" %>
  </div>
<% end %>
